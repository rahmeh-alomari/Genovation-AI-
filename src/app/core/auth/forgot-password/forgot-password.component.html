<div class="login-box">
  <h2 class="login-title">Forgot Password 🔐</h2>
  <p class="login-subtitle" *ngIf="step === 'email'">Enter your email to receive a reset code</p>
  <p class="login-subtitle" *ngIf="step === 'otp'">Enter the OTP and your new password</p>

  <form [formGroup]="forgotPasswordForm" class="login-form" (ngSubmit)="step === 'email' ? onSendOtp() : onResetPassword()">

    <!-- Step 1: Email -->
    <div class="form-group" *ngIf="step === 'email'">
      <label for="email">Email</label>
      <input
        pInputText
        id="email"
        type="email"
        formControlName="email"
        placeholder="you@example.com"
        class="form-control"
      />
      <small
        *ngIf="forgotPasswordForm.get('email')?.touched && forgotPasswordForm.get('email')?.invalid"
        class="error-msg"
      >
        Valid email is required
      </small>
    </div>

    <!-- Step 2: OTP + New Password -->
    <ng-container *ngIf="step === 'otp'">
      <div class="form-group">
        <label for="otp">OTP</label>
        <input
          pInputText
          id="otp"
          type="text"
          formControlName="otp"
          placeholder="Enter OTP"
          class="form-control"
        />
        <small
          *ngIf="forgotPasswordForm.get('otp')?.touched && forgotPasswordForm.get('otp')?.invalid"
          class="error-msg"
        >
          OTP is required
        </small>
      </div>

      <div class="form-group">
        <label for="newPassword">New Password</label>
        <input
          pInputText
          id="newPassword"
          type="password"
          formControlName="newPassword"
          placeholder="New password"
          class="form-control"
        />
        <small
          *ngIf="forgotPasswordForm.get('newPassword')?.touched && forgotPasswordForm.get('newPassword')?.invalid"
          class="error-msg"
        >
          Password must be at least 6 characters
        </small>
      </div>
    </ng-container>

    <!-- Submit button -->
    <button
      pButton
      type="submit"
      [label]="step === 'email' ? 'Send OTP' : 'Reset Password'"
      class="login-button"
      [disabled]="
        (step === 'email' && forgotPasswordForm.get('email')?.invalid) ||
        (step === 'otp' &&
          (forgotPasswordForm.get('otp')?.invalid || forgotPasswordForm.get('newPassword')?.invalid))
      "
    ></button>
  </form>
</div>
